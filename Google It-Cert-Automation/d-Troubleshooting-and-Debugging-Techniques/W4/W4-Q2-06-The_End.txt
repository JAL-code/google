Here are few hints to fix this issue:

    Download the file only once from the URL.

    Pre-process it so that the same calculation doesn't need to be done over and over again. This can be done in two ways. You can choose any one of them:

    To create a dictionary with the start dates and then use the data in the dictionary instead of the complicated calculation.
    To sort the data by start_date and then go date by date.

Choose any one of the above preprocessing options and modify the script accordingly.
